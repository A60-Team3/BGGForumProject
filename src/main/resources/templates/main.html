<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">


<head th:replace="~{/fragments/head.html :: head(title = 'Welcome to BGG Forum')}"></head>
<body>
<div class="py-5">
    <div class="container d-flex align-items-center flex-column">
        <form action="#" th:action="@{/BGGForum/main}" method="get" th:object="${postFilterOptions}">
            <h5 th:text="#{filter.label}">Filter Options</h5>
            <br/><br/>
            <div class="input-group">
                <input type="text" placeholder="Post Title" th:field="*{title}"/>
                <input type="text" placeholder="Post Content" th:field="*{content}"/>
                <select th:field="*{createCondition}">
                    <option value="">None</option>
                    <option value="<">'<'</option>
                    <option value="<=>">'<='</option>
                    <option value=">">'>'</option>
                    <option value=">=">'>='</option>
                    <option value="=">'='</option>
                    <option value="!=">'!='</option>
                </select>
                <input type="datetime-local" th:field="*{created}"/>
                <select th:field="*{updateCondition}">
                    <option value="">None</option>
                    <option value="<">'<'</option>
                    <option value="<=>">'<='</option>
                    <option value=">">'>'</option>
                    <option value=">=">'>='</option>
                    <option value="=">'='</option>
                    <option value="!=">'!='</option>
                </select>
                <input type="datetime-local" th:field="*{updated}"/>
                <select th:field="*{sortBy}">
                    <option value="">Sort By</option>
                    <option value="title">Title</option>
                    <option value="content">Content</option>
                    <option value="user">Creator</option>
                    <option value="created">Date Created</option>
                    <option value="updated">Date Updated</option>
                </select>
                <select th:field="*{sortOrder}">
                    <option value="">Sort Order</option>
                    <option value="asc">Ascending</option>
                    <option value="desc">Descending</option>
                </select>
                <div>
                    <label>Tags:</label>
                    <span th:each="tag : ${tags}">
                    <input type="checkbox" th:field="*{tags}" th:value="${tag.id}" id="tag-${tag.id}"/>
                    <label th:for="'tag-' + ${tag.id}" th:text="${tag.name}"></label>
                    </span>
                </div>
                <br/><br/>
            </div>

            <input class="btn btn-primary" type="submit" value="Search"/>
            <a class="btn btn-secondary" th:href="@{/BGGForum/main}" value="Clear Filters">Clear Filter</a>
        </form>
    </div>
</div>

<div class="body-content" th:if="${posts.isEmpty()}">
    <h2 th:text="#{posts.title.empty}">No Posts</h2>
</div>
<div class="container px-4 px-lg-5 mt-5" th:unless="${posts.isEmpty()}">
    <div class="margin12" th:each="post : ${posts}">
        <label th:text="#{post.label.title}  + ': '">Title</label>
        <span class="margin12">
                <a href="#" th:href="@{/posts/{id}(id=${post.id})}" th:text="${post.title}">Post</a>
            </span>
        <p class="margin12" th:text="#{post.label.content}  + ': ' +       ${post.content}">Post content</p>
        <p class="margin12"
           th:text="#{post.label.created}  + ': ' +       ${#temporals.format(post.createdAt, 'dd-MM-yyyy HH:mm')}">
            Time of Creation</p>
        <p class="margin12"
           th:text="#{post.label.updated}  + ': ' +       ${#temporals.format(post.updatedAt,'dd-MM-yyyy HH:mm')}">
            Last Updated</p>
        <p class="margin12" th:text="#{post.label.createdBy}  + ': ' +       ${post.userId.username}">Creator</p>
        <label th:text="#{post.label.tag}  + ': '">Tags:</label>
        <span class="margin12" th:each="tag, iterStat : ${post.tags}">
                <span th:text="${tag.name}">Tag Name</span>
                <span th:if="${!iterStat.last}">, </span>
            </span>
    </div>
</div>

<nav aria-label="Pagination" th:if="${totalPages > 0}">
    <ul class="pagination justify-content-center">
        <li class="page-item" th:classappend="${currentPage == 1} ? 'disabled'">
            <a th:replace="~{fragments/paging :: pagingPost(0, '<<', 'First Page')}"></a>
        </li>

        <li class="page-item font-weight-bold" th:classappend="${currentPage == 1} ? 'disabled'">
            <a th:replace="~{fragments/paging :: pagingPost(pageNum = ${currentPage - 2}, label = 'Prev', tooltip = 'Previous Page')}"></a>
        </li>

        <li class="page-item disabled" th:if="${currentPage - 2 > 1}">
            <a class="page-link" href="#">...</a>
        </li>

        <li class="page-item" th:classappend="${page == currentPage - 1} ? 'active'"
            th:each="page : ${#numbers.sequence(currentPage > 2 ? currentPage - 2 : 0, currentPage + 2 < totalPages ? currentPage + 2 : totalPages - 1)}">
            <a th:replace="~{fragments/paging :: pagingPost(pageNum = ${page}, label = ${page + 1}, tooltip = 'Page ' + ${page + 1})}"></a>
        </li>

        <li class="page-item disabled" th:if="${currentPage + 2 < totalPages}">
            <a class="page-link" href="#">...</a>
        </li>

        <li class="page-item font-weight-bold" th:classappend="${currentPage == totalPages} ? 'disabled'">
            <a th:replace="~{fragments/paging :: pagingPost(pageNum = ${currentPage}, label = 'Next', tooltip = 'Next Page')}"></a>
        </li>

        <li class="page-item" th:classappend="${currentPage == totalPages} ? 'disabled'">
            <a th:replace="~{fragments/paging :: pagingPost(pageNum = ${totalPages - 1}, label = '>>', tooltip = 'Last Page')}"></a>
        </li>
    </ul>
</nav>

<footer th:replace="~{/fragments/footer.html::footer}"></footer>
<div th:replace="~{/fragments/scripts.html}"></div>
</body>
</html>